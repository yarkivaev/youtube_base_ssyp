## типы
u8, u16, u32, u64 - unsigned целые числа

все числа в **big endian**

string = [u32 - length in bytes] [utf-8 encoded characters]

videoinfo = [u32 - channel id] [u32 - segment amount] [u8 - segment length] [u8 - max quality] [string - author name] [string - title] [string - description]

channelinfo = [string - name] [string - description] [u32 - subscribers] [u32 - owner] [u32 - video amount]

## пакеты
пакет от клиента к серверу начинается с байта команды

### 0x00 - получить инфу о видео
**С->S**: 0x00 [u32 - video id]

**S->C**: [videoinfo]

### 0x01 - получить сегмент видео
**С->S**: 0x01 [u32 - video id] [u32 - segment id] [u8 - quality]

**S->C**: [u32 - size] [bytes]

### 0x02 - список видео
**С->S**: 0x02

**S->C**: [u32 - count] count*([u32 - video id] [videoinfo])

### 0x03 - войти в аккаунт
**С->S**: 0x03 [string - username] [string - password]

если успешно: **S->C**: 0x00 [string - token]

если нет такого аккаунта: **S->C**: 0x01

если неверный пароль: **S->C**: 0x02

### 0x04 - создать аккаунт
**С->S**: 0x04 [string - username] [string - password]

если успешно: **S->C**: 0x00 [string - token]

если ник занаят: **S->C**: 0x01

если ник/пароль не подходят: **S->C**: 0x02

(например если в нике спец. символы или пароль пустой)

### 0x05 - загрузить видео
**С->S**: 0x05 [string - token] [u32 - channel id] [string - title] [string - description] [u64 - file size] [file bytes]

пока обрабатывается: **S->C**: 0x00 [u8 - progress]

отправляется много раз, progress в процентах (от 0 до 100)

если ошибка: **S->C**: 0x01

если успешно: **S->C**: 0x02 [u32 - video id]

### 0x06 - удалить видео
**С->S**: 0x06 [string - token] [u32 - video id]

если успешно: **S->C**: 0x00

если нет такого видео или он принадлежит другому пользователю: **S->C**: 0x01

### 0x07 - получить информацию о канале
**C->S**: 0x07 [u32 - channel id]

**S->C**: [channelinfo] 

### 0x08 - создать канал
**C->S**: 0x08 [string - token] [string - name] [string - description]

если успешно: **S->C**: 0x00 [u32 - channel id]

если токен неправильный: **S->C**: 0x01

если название занято: **S->C**: 0x02

если имя/описание не подходят: **S->C**: 0x03

(например если имя или описание пустое)

### 0x09 - удалить канал
**С->S**: 0x09 [string - token] [u32 - channel id]

если успешно: **S->C**: 0x00

если нет такого канала: **S->C**: 0x01

если канал принадлежит другому пользователю: **S->C**: 0x02

### 0x0A - получить несколько видео канала
**С->S**: 0x0A [u32 - channel id] [u32 - start video] [u32 - count]

если успешно: **S->C**: 0x00 count*([u32 - video id])

если нет такого канала: **S->C**: 0x01

если номер стартового видео или кол-во видео не подходят: **S->C**: 0x02

### 0x0B - подписаться на канал
**C->S**: 0x0B [string - token] [u32 - channel id]

если успешно: **S->C**: 0x00

если нет такого канала: **S->C**: 0x01

### 0x0C - отписаться от канала
**C->S**: 0x0C [string - token] [u32 - channel id]

если успешно: **S->C**: 0x00

если нет такого канала: **S->C**: 0x01

пользователь не подписан на канал: **S->C**: 0x02

### 0x0D - редактировать информацию о видео
**C->S**: 0x0D [string - token] [u32 - video id] [u8 - edit description] [edit data: [string - title] (if needed) [string - description] (if needed) [u64 - file size] [file bytes] (if needed)]

**S->C**:
- Если данные видео не редактируются:
    - успешно: 0х00
    - нет доступа (или неверный токен): 0х01
- Если данные видео редактируются:
    - пока обрабатывается: 0x00 [u8 - progress]
    - нет доступа (или неверный токен): 0х01
    - После обработки:
    - 0х02: ошибка обработки

Обозначение изменений в edit description:

Бит 7 (**0x80**) - редактирование заголовок

Бит 6 (**0x40**) - редактирование описания

Бит 5 (**0x20**) - редактирование (повторная загрузка) данных

биты 4-0 зарезервированы

Возможно редактирование нескольких полей одновременно, для этого сложите необходимые сигналы.

Например: отредактировать название и описание = бит 1 + бит 2 = _0x08 + 0x04 = 0xC0_

Данные передаются в порядке: **заголовок -> описание -> видео**, с пропуском при необходимости

Название и описание передаются как строки, файл как [u64 - file size] [file bytes]


### 0x0E -  список каналов определённого пользавателя
**C->S**: 0x0E [string - token] 

**S->C**: [u32 - count]count*([u32 - channelid][channelinfo])